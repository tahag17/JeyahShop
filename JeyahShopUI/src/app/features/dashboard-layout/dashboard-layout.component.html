<div class="flex h-full w-full">
  <!-- Sidebar (desktop) -->
  <aside
    class="pt-14 sticky top-0 left-0 h-screen basis-60 shrink-0 flex flex-col border-r border-border pl-2 pb-4 bg-surfaceLight dark:bg-surfaceDark z-50 hidden lg:flex"
  >
    <!-- Logo + Dark Mode Toggle -->
    <div class="px-4 py-2 flex items-center justify-between">
      <div
        class="text-2xl font-bold font-heading text-primaryTail dark:text-primaryDarkTail cursor-pointer"
        (click)="navigate('/dashboard')"
      >
        Jeyah
      </div>
      <app-dark-mode-toggle></app-dark-mode-toggle>
    </div>

    <!-- Navigation -->
    <nav
      class="flex-1 flex flex-col mt-6 gap-2 text-textLight dark:text-textDark"
    >
      <a
        routerLink="/dashboard"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        [routerLinkActiveOptions]="{ exact: true }"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-chart-line w-5"></i> Dashboard
      </a>
      <a
        routerLink="/dashboard/products"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-box w-5"></i> Products
      </a>
      <a
        routerLink="/dashboard/orders"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-receipt w-5"></i> Orders
      </a>

      <a
        routerLink="/dashboard/categories"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-tags w-5"></i> Categories
      </a>

      <a
        routerLink="/settings"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-gear w-5"></i> Settings
      </a>
      <a
        routerLink="/products"
        routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
        class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
      >
        <i class="fa-solid fa-shop w-5"></i> Shop
      </a>
    </nav>

    <!-- Footer -->
    <div class="mt-auto px-4 py-2 text-sm text-infoTail dark:text-infoDarkTail">
      Â© 2025 Jeyah
    </div>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col h-full bg-bgLight dark:bg-bgDark">
    <!-- Mini Header -->
    <header
      class="h-14 bg-surfaceLight dark:bg-surfaceDark text-textLight dark:text-textDark px-4 flex justify-between items-center shadow-sm sticky top-0 z-30"
    >
      <div class="flex items-center gap-4">
        <!-- Hamburger for mobile -->
        <button
          class="lg:hidden p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-all"
          (click)="toggleSidebar()"
        >
          <i class="fa-solid fa-bars"></i>
        </button>

        <!-- Dashboard text hidden on mobile -->
        <div
          class="font-semibold text-lg cursor-pointer hidden lg:block"
          (click)="navigate('/dashboard')"
        >
          Dashboard
        </div>
      </div>

      <!-- Search bar (always visible) -->
      <div class="flex-1 flex justify-center mx-1 sm:mx-4 relative max-w-lg">
        <div
          class="flex w-full border border-gray-300 dark:border-gray-600 rounded overflow-hidden transition-all duration-200 focus-within:ring-2 focus-within:ring-accentTail dark:focus-within:ring-accentDarkTail"
        >
          <input
            type="text"
            placeholder="Rechercher..."
            [(ngModel)]="searchInput"
            (input)="onSearch()"
            (focus)="showSearchSuggestions = true"
            (blur)="hideSuggestions()"
            class="flex-1 px-2 sm:px-3 py-1 text-textLight dark:text-textDark focus:outline-none bg-transparent"
          />
          <button
            class="bg-accentTail dark:bg-accentDarkTail text-white px-2 sm:px-3 py-1 hover:bg-accentTail/80 dark:hover:bg-accentDarkTail/80 transition"
            (click)="onSearch()"
          >
            <i class="fa-solid fa-magnifying-glass"></i>
          </button>
        </div>

        <!-- Search suggestions dropdown -->
        <ul
          *ngIf="showSearchSuggestions && filteredSuggestions.length"
          class="absolute top-full mt-1 w-full bg-surfaceLight dark:bg-surfaceDark border border-gray-300 dark:border-gray-600 rounded shadow-lg z-50 max-h-60 overflow-y-auto"
        >
          <li
            *ngFor="let suggestion of filteredSuggestions"
            (mousedown)="selectSuggestion(suggestion)"
            class="px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer text-textLight dark:text-textDark"
          >
            {{ suggestion }}
          </li>
        </ul>
      </div>
    </header>

    <!-- Mobile Overlay Sidebar -->
    <div
      *ngIf="sidebarOpen"
      class="fixed inset-0 z-50 flex"
      [ngClass]="{
        'animate-slide-in': sidebarOpen,
        'animate-slide-out': !sidebarOpen
      }"
    >
      <!-- Overlay -->
      <div
        class="absolute inset-0 bg-black bg-opacity-50"
        (click)="toggleSidebar()"
      ></div>

      <!-- Sidebar panel -->
      <aside
        class="relative w-64 h-full bg-surfaceLight dark:bg-surfaceDark p-4 flex flex-col z-50 transform transition-transform duration-300"
      >
        <!-- Logo + dark mode toggle -->
        <div class="flex items-center justify-between mb-6">
          <div
            class="text-2xl font-bold font-heading text-primaryTail dark:text-primaryDarkTail cursor-pointer"
            (click)="navigate('/dashboard')"
          >
            Jeyah
          </div>
          <app-dark-mode-toggle></app-dark-mode-toggle>
        </div>

        <!-- Navigation -->
        <nav
          class="flex-1 flex flex-col gap-2 text-textLight dark:text-textDark"
        >
          <a
            routerLink="/dashboard"
            routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
            (click)="navigate('/dashboard')"
          >
            <i
              class="fa-solid fa-chart-line w-5 text-textLight dark:text-textDark"
            ></i>
            Dashboard
          </a>
          <a
            routerLink="/products"
            routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
            (click)="navigate('/dashboard/products')"
          >
            <i
              class="fa-solid fa-box w-5 text-textLight dark:text-textDark"
            ></i>
            Products
          </a>
          <a
            routerLink="/orders"
            routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
            (click)="navigate('/dashboard/orders')"
          >
            <i
              class="fa-solid fa-receipt w-5 text-textLight dark:text-textDark"
            ></i>
            Orders
          </a>
          <a
            routerLink="/settings"
            routerLinkActive="bg-accentTail/50 dark:bg-accentDarkTail/50 font-semibold"
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-accentTail/30 dark:hover:bg-accentDarkTail/30 transition-all duration-200 cursor-pointer"
            (click)="navigate('/settings')"
          >
            <i
              class="fa-solid fa-gear w-5 text-textLight dark:text-textDark"
            ></i>
            Settings
          </a>
        </nav>

        <!-- Mobile user actions -->
        <div
          class="mt-6 flex flex-col gap-2 border-t border-gray-200 dark:border-gray-700 pt-4 text-textLight dark:text-textDark"
        >
          <button
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition"
            (click)="navigate('/dashboard/profile')"
          >
            <i class="fa-regular fa-user"></i>
            Profile
          </button>
          <button
            class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition"
            (click)="logout()"
          >
            <i class="fa-solid fa-power-off"></i>
            Logout
          </button>
        </div>
      </aside>
    </div>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-auto p-6 w-full">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>
